package appointment;

import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;

import javafx.scene.layout.HBox;
import javafx.stage.Stage;
import javafx.scene.control.TextField;
import javafx.scene.control.TreeItem;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;

import java.net.URL;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.ResourceBundle;

import javax.security.auth.callback.LanguageCallback;

import calendar.CalendarController;
import category.CategoriesController;
import javafx.application.Platform;
import javafx.event.ActionEvent;

import javafx.scene.control.CheckBox;

import javafx.scene.control.DatePicker;
import javafx.scene.control.ChoiceBox;

public class AppointmentCreatorController implements Initializable
{
	@FXML
	private TextField AppointmentTitle;
	@FXML
	private HBox AppointmentStartDate;
	@FXML
	private TextField AppointmentStartTime;
	@FXML
	private DatePicker AppointmentEndDate;
	@FXML
	private TextField AppointmentEndTime;
	@FXML
	private CheckBox AppointmentRegularlyOnOff;
	@FXML
	private ChoiceBox AppointmentRegularlyType;
	@FXML
	private CheckBox AppointmentAllDay;
	@FXML
	private Button AppoinmentPinNote;
	@FXML
	private CheckBox AppointmentAlarmOnOff;
	@FXML
	private DatePicker AppointmentAlarmDate;
	@FXML
	private TextField AppointmentAlarmTime;
	@FXML
	private Button AppointmentSave;
	@FXML
	private ChoiceBox<TreeItem<String>> chooseCategory = new ChoiceBox<>();
	Image icon = new Image(getClass().getResourceAsStream("/images/Kalender.png"));
	// Event Listener on Button[#AppoinmentPinNote].onAction jk
	@FXML
	public void appointmentPinNotePress(ActionEvent event) 
	{
		// TODO Autogenerated
	}
	// Event Listener on Button[#AppointmentSave].onAction
	@FXML
	public void appointmentSavePress(ActionEvent event) 
	{
		// TODO Autogenerated
		//Save the current Category	
		if (!chooseCategory.getSelectionModel().getSelectedItem().equals(null))
		{
			TreeItem<String> savePosition = chooseCategory.getSelectionModel().getSelectedItem();
			TreeItem<String> newItem = new TreeItem<String>("Termin: "+AppointmentTitle.getText(), new ImageView(icon));
			CategoriesController.insertCategoryByCreator(savePosition, newItem);
		}
		//Save the appointment
		LocalDate save = AppointmentEndDate.getValue();
		CalendarController.addAppointment(save, AppointmentTitle.getText());
	}
	@Override
	public void initialize(URL location, ResourceBundle resources)
	{
		for(int i = 0; i < CategoriesController.getMainCategories().size(); i++)
		{
			chooseCategory.getItems().addAll(CategoriesController.getMainCategories().get(i));
		}
	  }
    }
